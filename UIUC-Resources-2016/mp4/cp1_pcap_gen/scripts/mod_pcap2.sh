#!/bin/bash
# check arguments
if [ "$#" -ne 3 ]; then
  echo "usage: sudo ./edit_pcap.sh {message} {original_pcap} {output_dir} in absolute paths"
  exit 1
fi

ORIG_MSG="2544302539452544312538312544312538322544302542302544302542442544302542452544302542322544302542382544312538322544312538432532302544302542442544312538452544312538352544302542302544312538452544312538322532304d792532305769466921"
NEW_MSG="$1"
OUTPUT="$3/4.1.2.pcap"

hexdump -ve '1/1 "%.2x"' "$2" | sed "s/${ORIG_MSG}/${NEW_MSG}/g" | xxd -r -p > "${OUTPUT}"
