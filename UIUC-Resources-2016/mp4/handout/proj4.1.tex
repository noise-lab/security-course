%Checkpoint 1
%points
\newcounter{pts-cp1}
\newcounter{pts-cp1.1}
\newcounter{pts-hosts}  \setcounter{pts-hosts}{3}
\newcounter{pts-tcp} \setcounter{pts-tcp}{1}
\newcounter{pts-gw} \setcounter{pts-gw}{2}
\newcounter{pts-ftp} \setcounter{pts-ftp}{3}
\newcounter{pts-portscan} \setcounter{pts-portscan}{1}
\setcounter{pts-cp1.1}{
    \value{pts-hosts}+\value{pts-tcp}+\value{pts-gw}+\value{pts-ftp}+\value{pts-portscan}
}
\newcounter{pts-cp1.2}
\newcounter{pts-year} \setcounter{pts-year}{1}
\newcounter{pts-domain} \setcounter{pts-domain}{1}
\newcounter{pts-cslist} \setcounter{pts-cslist}{1}
\newcounter{pts-servercs} \setcounter{pts-servercs}{1}
\newcounter{pts-name} \setcounter{pts-name}{2}
\newcounter{pts-msg} \setcounter{pts-msg}{3}
\newcounter{pts-cookie} \setcounter{pts-cookie}{1}
\setcounter{pts-cp1.2}{
    \value{pts-domain}+\value{pts-cslist}+\value{pts-servercs}+\value{pts-year}+\value{pts-name}+\value{pts-msg}+\value{pts-cookie}
}
\setcounter{pts-cp1}{\value{pts-cp1.1}+\value{pts-cp1.2}}

\section{Checkpoint 1 (\arabic{pts-cp1} points)}
\label{sec:cp1}

Security analysts and attackers both frequently study network traffic to search for vulnerabilities and to characterize network behavior.
In this section, you will examine a network trace from a sample network we set up for this assignment.
You will search for specific details using Wireshark network packet analyzer (\url{https://www.wireshark.org}).

\subsection{Exploring Network Traces (\arabic{pts-cp1.1} points)}
\label{sec:cp1.1}
Examine the first network trace, \texttt{4.1.1.pcap}, using Wireshark.

\medskip

Provide concise answers to the following questions.

% Checkpoint 1.1 filenames
\newcommand{\filemac}{\ref*{sec:cp1.1}.\ref*{itm:macip}\_mac.txt}
\newcommand{\fileip}{\ref*{sec:cp1.1}.\ref*{itm:macip}\_ip.txt}
\newcommand{\filetcp}{\ref*{sec:cp1.1}.\ref*{itm:tcp}.txt}
\newcommand{\filegw}{\ref*{sec:cp1.1}.\ref*{itm:gw}.txt}
\newcommand{\fileactive}{\ref*{sec:cp1.1}.\ref*{itm:ftp}\_active.txt}
\newcommand{\filepassive}{\ref*{sec:cp1.1}.\ref*{itm:ftp}\_passive.txt}
\newcommand{\fileportscan}{\ref*{sec:cp1.1}.\ref*{itm:portscan}.txt}

\begin{enumerate}
  \item \hypertarget{cp1macip}{Identify all the hosts on the local network. (\arabic{pts-hosts} points)} \label{itm:macip}

    \begin{enumerate}[label=\alph*),nosep]
      \item What are their IP addresses?
      \item What are their MAC addresses? Assume that each IP address is mapped to one MAC address.
    \end{enumerate}

    \textbf{What to submit}\hspace{10pt}
    Submit a) \texttt{\hyperlink{ipformat}{\fileip}} that contains the IP addresses and\\
    b) \texttt{\hyperlink{macformat}{\filemac}} that contains the MAC addresses.
    Write one address per line.

  \item \hypertarget{cp1tcp}{How many unique TCP conversations, also known as TCP sessions, are there? (\arabic{pts-tcp} points)} \label{itm:tcp}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{tcpformat}{\filetcp}} that contains the number of unique TCP conversations.
    Write the number only.

  \item \hypertarget{cp1gw}{What is the IP address of the gateway? (\arabic{pts-gw} points)} \label{itm:gw}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{gwformat}{\filegw}} that contains the IP address of the gateway.
  \item \hypertarget{cp1ftp}{Retrieve and submit the content of the files downloaded from the FTP servers. (\arabic{pts-ftp} points)} \label{itm:ftp}

    \textbf{What to submit}\hspace{10pt}
    Submit a) \texttt{\hyperlink{activeformat}{\fileactive}} that contains the content of the file downloaded from the \textit{active} FTP server
    and b) \texttt{\hyperlink{passiveformat}{\filepassive}} that contains the content of the file downloaded from the \textit{passive} FTP server.

  \item \hypertarget{cp1portscan}{One of the hosts performed port scanning, a technique used to find network hosts that have services listening on targeted ports.\\
  What is the IP address of the port scanner? (\arabic{pts-portscan} points)} \label{itm:portscan}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{portscanformat}{\fileportscan}} that contains the IP address of the port scanner.

\end{enumerate}

Check your answer formats with the examples provided under \textit{\nameref{sec:cp1checklist}}.

\newpage

\subsection{HTTPS Traffic (\arabic{pts-cp1.2} points)}
\label{sec:cp1.2}
Examine the second network trace, \texttt{4.1.2.pcap}, using Wireshark.

\medskip

Provide concise answers to the following questions.

% Checkpoint 1.2 filenames
\newcommand{\fileyear}{\ref*{sec:cp1.2}.\ref*{itm:year}.txt}
\newcommand{\filedomain}{\ref*{sec:cp1.2}.\ref*{itm:domain}.txt}
\newcommand{\filecslist}{\ref*{sec:cp1.2}.\ref*{itm:cslist}.txt}
\newcommand{\fileservercs}{\ref*{sec:cp1.2}.\ref*{itm:servercs}.txt}
\newcommand{\filename}{\ref*{sec:cp1.2}.\ref*{itm:name}.txt}
\newcommand{\filemsg}{\ref*{sec:cp1.2}.\ref*{itm:msg}.txt}
\newcommand{\filecookie}{\ref*{sec:cp1.2}.\ref*{itm:cookie}.txt}

\begin{enumerate}
  \item \hypertarget{cp1year}{In what year was this traffic captured? (\arabic{pts-year} points)} \label{itm:year}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{yearformat}{\fileyear}} that contains the year. Write the number only.

  \item \hypertarget{cp1domain}{What is the hostname (or Fully Qualified Domain Name) of the server that the client connected to? (\arabic{pts-domain} points)} \label{itm:domain}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{domainformat}{\filedomain}} that contains the hostname of the website.

  \item \hypertarget{cp1cslist}{During TLS handshakes, the client(s) provided a list of supported cipher suites.\\
  List the supported cipher suites from one of the clients. (\arabic{pts-cslist} points)} \label{itm:cslist}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{cslistformat}{\filecslist}} that contains the list of the supported cipher suites.
    Write one cipher suite per line.
    The name and hex Cipher ID of each cipher suite MUST be as shown in Wireshark.

  \item \hypertarget{cp1servercs}{Which cipher suite did the server choose for the connection? (\arabic{pts-servercs} points)} \label{itm:servercs}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{servercsformat}{\fileservercs}} that contains the cipher suite chosen by the server.
    The name and hex Cipher ID of the cipher suite MUST be as shown in Wireshark.

  \item \hypertarget{cp1name}{A user of the client searched a person's name on the website.\\
  What is the first name of this person? (\arabic{pts-name} points)} \label{itm:name}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{nameformat}{\filename}} that contains only the first name of the person searched on the website.

  \item \hypertarget{cp1msg}{The user sent a message to the person found in \hyperlink{cp1name}{\ref*{sec:cp1.2}.\ref*{itm:name}}.\\
  What is the \textit{body} of the message? (\arabic{pts-msg} points)} \label{itm:msg}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{msgformat}{\filemsg}} that contains the \textit{body} of the message.
    The message should be 112 characters long.

  \item \hypertarget{cp1cookie}{Export and submit the user's cookie used in sending the message. (\arabic{pts-cookie} points)} \label{itm:cookie}

    \textbf{What to submit}\hspace{10pt}
    Submit \texttt{\hyperlink{cookieformat}{\filecookie}} that contains the user's cookie.
    Your answer should include only the content, not the ``Cookie: '' prefix.

\end{enumerate}

Check your answer formats with the examples provided under \textit{\nameref{sec:cp1checklist}}.

\newpage

\section*{Checkpoint 1: Submission Checklist}
\label{sec:cp1checklist}

Inside your mp4 SVN repository, you will have auto-generated files named as below.\\
Make sure that your answers for all tasks up to this point are submitted in the following files by \textbf{\checkpointduedate} at \textbf{\duetime}.

\subsection*{SVN Repository}
\nolinkurl{\svnrepo}

\subsection*{Team Members}
\texttt{partners.txt} : a text file containing NETIDs of both members, one NETID per line.\\
Place the NETID of the student making the submission in the first line.
\vspace{-12pt}
\hypertarget{cp1partners}{}
\subsubsection*{example content of \texttt{partners.txt}}
\begin{mdframed}
\begin{Verbatim}
your_netid
partner_netid
\end{Verbatim}
\end{mdframed}

\subsection*{Solution Format}

\hypertarget{ipformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1macip}{\fileip}}}
\begin{mdframed}
\begin{Verbatim}
1.2.3.4
127.0.0.1
\end{Verbatim}
\end{mdframed}

\hypertarget{macformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1macip}{\filemac}}}
\begin{mdframed}
\begin{Verbatim}
0f:0f:0f:0f:0f:0f
1e:1e:1e:1e:1e:1e
\end{Verbatim}
\end{mdframed}

\hypertarget{tcpformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1tcp}{\filetcp}}}
\begin{mdframed}
\begin{Verbatim}
461
\end{Verbatim}
\end{mdframed}

\hypertarget{gwformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1gw}{\filegw}}}
\begin{mdframed}
\begin{Verbatim}
8.8.8.8
\end{Verbatim}
\end{mdframed}

\hypertarget{activeformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1ftp}{\fileactive}}}
\begin{mdframed}
\begin{Verbatim}
content_from_active_FTP!@($!@:+_
\end{Verbatim}
\end{mdframed}

\pagebreak

\hypertarget{passiveformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1ftp}{\filepassive}}}
\begin{mdframed}
\begin{Verbatim}
content_from_passive_FTP!@($!@:+_
\end{Verbatim}
\end{mdframed}

\hypertarget{portscanformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1portscan}{\fileportscan}}}
\begin{mdframed}
\begin{Verbatim}
192.168.1.254
\end{Verbatim}
\end{mdframed}

\hypertarget{yearformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1year}{\fileyear}}}
\begin{mdframed}
\begin{Verbatim}
1970
\end{Verbatim}
\end{mdframed}

\hypertarget{domainformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1domain}{\filedomain}}}
\begin{mdframed}
\begin{Verbatim}
www.example.com
\end{Verbatim}
\end{mdframed}
\vspace{-15pt}
\begin{mdframed}
\begin{Verbatim}
blog.example.com
\end{Verbatim}
\end{mdframed}

\hypertarget{cslistformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1cslist}{\filecslist}}}
\begin{mdframed}
\begin{Verbatim}
TLS_ECDHE_RSA_WITH_RC4_128_SHA (0xc011)
TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)
\end{Verbatim}
\end{mdframed}

\hypertarget{servercsformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1servercs}{\fileservercs}}}
\begin{mdframed}
\begin{Verbatim}
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)
\end{Verbatim}
\end{mdframed}

\hypertarget{nameformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1name}{\filename}}}
\begin{mdframed}
\begin{Verbatim}
john
\end{Verbatim}
\end{mdframed}

\hypertarget{msgformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1msg}{\filemsg}}}
\begin{mdframed}
\begin{Verbatim}
========security is kewl; blah blah blah @#$!)$(@ this message is in a si
ngle line.=============================
\end{Verbatim}
\end{mdframed}

\hypertarget{cookieformat}{}
\subsubsection*{example content of \texttt{\hyperlink{cp1cookie}{\filecookie}}}
\begin{mdframed}
\begin{Verbatim}
__utma=44258684.1258198627.1456687180.1457965376.1458137415.4; __utmc=442
58684; __utmz=44258684.1457965376.3.3.utmcsr=isss.illinois.edu|utmccn=(re
ferral)|utmcmd=referral|utmcct=/
\end{Verbatim}
\end{mdframed}

\pagebreak

\subsection*{List of files that must be submitted for Checkpoint 1}

\begin{itemize}
\item \texttt{\hyperlink{cp1partners}{partners.txt}}
\item \texttt{\hyperlink{cp1macip}{\filemac}}
\item \texttt{\hyperlink{cp1macip}{\fileip}}
\item \texttt{\hyperlink{cp1tcp}{\filetcp}}
\item \texttt{\hyperlink{cp1gw}{\filegw}}
\item \texttt{\hyperlink{cp1ftp}{\fileactive}}
\item \texttt{\hyperlink{cp1ftp}{\filepassive}}
\item \texttt{\hyperlink{cp1portscan}{\fileportscan}}
\item \texttt{\hyperlink{cp1year}{\fileyear}}
\item \texttt{\hyperlink{cp1domain}{\filedomain}}
\item \texttt{\hyperlink{cp1cslist}{\filecslist}}
\item \texttt{\hyperlink{cp1servercs}{\fileservercs}}
\item \texttt{\hyperlink{cp1name}{\filename}}
\item \texttt{\hyperlink{cp1msg}{\filemsg}}
\item \texttt{\hyperlink{cp1cookie}{\filecookie}}
\end{itemize}
